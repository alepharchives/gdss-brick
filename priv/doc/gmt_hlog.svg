<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="900px" height="747px" version="1.1"
 viewbox="0 0 900 747"
 xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"
 stroke-width="1" text-rendering="geometricPrecision">
<text x="112" y="15" textLength="26" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

Brick
</text>
<text x="337" y="15" textLength="48" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

LocalLog
</text>
<text x="562" y="15" textLength="75" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

LocalLogSync
</text>
<text x="787" y="15" textLength="49" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

HelpProc
</text>
<line x1="112" y1="22" x2="112" y2="47" stroke="black"/>
<line x1="337" y1="22" x2="337" y2="47" stroke="black"/>
<line x1="562" y1="22" x2="562" y2="47" stroke="black"/>
<line x1="787" y1="22" x2="787" y2="47" stroke="black"/>
<text x="403" y="37" textLength="92" font-family="Helvetica" font-size="12" fill="black">
Brick initialization
</text>
<line x1="56" y1="34" x2="402" y2="34" stroke="black" stroke-dasharray="2,2"/>
<line x1="498" y1="34" x2="844" y2="34" stroke="black" stroke-dasharray="2,2"/>
<line x1="112" y1="47" x2="112" y2="72" stroke="black"/>
<line x1="337" y1="47" x2="337" y2="72" stroke="black"/>
<line x1="562" y1="47" x2="562" y2="72" stroke="black"/>
<line x1="787" y1="47" x2="787" y2="72" stroke="black"/>
<line x1="112" y1="59" x2="337" y2="59" stroke="black"/>
<line x1="337" y1="59" x2="327" y2="65" stroke="black"/>
<text x="191" y="57" textLength="66" font-family="Helvetica" font-size="12" fill="black">
spawn, init...
</text>
<line x1="112" y1="72" x2="112" y2="97" stroke="black"/>
<line x1="337" y1="72" x2="337" y2="97" stroke="black"/>
<line x1="562" y1="72" x2="562" y2="97" stroke="black"/>
<line x1="787" y1="72" x2="787" y2="97" stroke="black"/>
<path d="M 336 89 A112,6 0 0,1 337,78" stroke="black" fill="none"/><polygon fill="black" points="337,90 327,96 327,84"/>
<text x="338" y="82" textLength="124" font-family="Helvetica" font-size="12" fill="black">
Open short term log file
</text>
<line x1="112" y1="97" x2="112" y2="122" stroke="black"/>
<line x1="337" y1="97" x2="337" y2="122" stroke="black"/>
<line x1="562" y1="97" x2="562" y2="122" stroke="black"/>
<line x1="787" y1="97" x2="787" y2="122" stroke="black"/>
<path d="M 336 114 A112,6 0 0,1 337,103" stroke="black" fill="none"/><polygon fill="black" points="337,115 327,121 327,109"/>
<text x="338" y="107" textLength="120" font-family="Helvetica" font-size="12" fill="black">
Open long term log file
</text>
<line x1="112" y1="122" x2="112" y2="147" stroke="black"/>
<line x1="337" y1="122" x2="337" y2="147" stroke="black"/>
<line x1="562" y1="122" x2="562" y2="147" stroke="black"/>
<line x1="787" y1="122" x2="787" y2="147" stroke="black"/>
<line x1="112" y1="134" x2="562" y2="134" stroke="black"/>
<line x1="562" y1="134" x2="552" y2="140" stroke="black"/>
<text x="303" y="132" textLength="66" font-family="Helvetica" font-size="12" fill="black">
spawn, init...
</text>
<line x1="112" y1="147" x2="112" y2="172" stroke="black"/>
<line x1="337" y1="147" x2="337" y2="172" stroke="black"/>
<line x1="562" y1="147" x2="562" y2="172" stroke="black"/>
<line x1="787" y1="147" x2="787" y2="172" stroke="black"/>
<text x="372" y="162" textLength="154" font-family="Helvetica" font-size="12" fill="black">
Write a hunk asynchronously
</text>
<line x1="56" y1="159" x2="371" y2="159" stroke="black" stroke-dasharray="2,2"/>
<line x1="529" y1="159" x2="844" y2="159" stroke="black" stroke-dasharray="2,2"/>
<line x1="112" y1="172" x2="112" y2="197" stroke="black"/>
<line x1="337" y1="172" x2="337" y2="197" stroke="black"/>
<line x1="562" y1="172" x2="562" y2="197" stroke="black"/>
<line x1="787" y1="172" x2="787" y2="197" stroke="black"/>
<line x1="112" y1="184" x2="337" y2="184" stroke="black"/>
<line x1="337" y1="184" x2="327" y2="190" stroke="black"/>
<text x="123" y="182" textLength="203" font-family="Helvetica" font-size="12" fill="black">
write_hunk(shortterm|longterm, Bytes)
</text>
<line x1="112" y1="197" x2="112" y2="222" stroke="black"/>
<line x1="337" y1="197" x2="337" y2="222" stroke="black"/>
<line x1="562" y1="197" x2="562" y2="222" stroke="black"/>
<line x1="787" y1="197" x2="787" y2="222" stroke="black"/>
<path d="M 336 214 A112,6 0 0,1 337,203" stroke="black" fill="none"/><polygon fill="black" points="337,215 327,221 327,209"/>
<text x="338" y="207" textLength="97" font-family="Helvetica" font-size="12" fill="black">
Write to short|long
</text>
<line x1="112" y1="222" x2="112" y2="247" stroke="black"/>
<line x1="337" y1="222" x2="337" y2="247" stroke="black"/>
<line x1="562" y1="222" x2="562" y2="247" stroke="black"/>
<line x1="787" y1="222" x2="787" y2="247" stroke="black"/>
<line x1="337" y1="234" x2="112" y2="234" stroke="black"/>
<line x1="112" y1="234" x2="122" y2="240" stroke="black"/>
<text x="168" y="232" textLength="112" font-family="Helvetica" font-size="12" fill="black">
{ok, SeqNum, Offset}
</text>
<line x1="112" y1="247" x2="112" y2="272" stroke="black"/>
<line x1="337" y1="247" x2="337" y2="272" stroke="black"/>
<line x1="562" y1="247" x2="562" y2="272" stroke="black"/>
<line x1="787" y1="247" x2="787" y2="272" stroke="black"/>
<path d="M 111 264 A112,6 0 0,1 112,253" stroke="black" fill="none"/><polygon fill="black" points="112,265 102,271 102,259"/>
<text x="113" y="257" textLength="162" font-family="Helvetica" font-size="12" fill="black">
Send Mods downstream, etc...
</text>
<line x1="112" y1="272" x2="112" y2="297" stroke="black"/>
<line x1="337" y1="272" x2="337" y2="297" stroke="black"/>
<line x1="562" y1="272" x2="562" y2="297" stroke="black"/>
<line x1="787" y1="272" x2="787" y2="297" stroke="black"/>
<text x="376" y="287" textLength="147" font-family="Helvetica" font-size="12" fill="black">
Write a hunk synchronously
</text>
<line x1="56" y1="284" x2="375" y2="284" stroke="black" stroke-dasharray="2,2"/>
<line x1="526" y1="284" x2="844" y2="284" stroke="black" stroke-dasharray="2,2"/>
<line x1="112" y1="297" x2="112" y2="322" stroke="black"/>
<line x1="337" y1="297" x2="337" y2="322" stroke="black"/>
<line x1="562" y1="297" x2="562" y2="322" stroke="black"/>
<line x1="787" y1="297" x2="787" y2="322" stroke="black"/>
<path d="M 111 314 A112,6 0 0,1 112,303" stroke="black" fill="none"/><polygon fill="black" points="112,315 102,321 102,309"/>
<text x="113" y="307" textLength="168" font-family="Helvetica" font-size="12" fill="black">
Incr. chain serial number: Serial
</text>
<line x1="112" y1="322" x2="112" y2="347" stroke="black"/>
<line x1="337" y1="322" x2="337" y2="347" stroke="black"/>
<line x1="562" y1="322" x2="562" y2="347" stroke="black"/>
<line x1="787" y1="322" x2="787" y2="347" stroke="black"/>
<line x1="112" y1="334" x2="337" y2="334" stroke="black"/>
<line x1="337" y1="334" x2="327" y2="340" stroke="black"/>
<text x="148" y="332" textLength="153" font-family="Helvetica" font-size="12" fill="black">
write_hunk(shortterm, Bytes)
</text>
<line x1="112" y1="347" x2="112" y2="372" stroke="black"/>
<line x1="337" y1="347" x2="337" y2="372" stroke="black"/>
<line x1="562" y1="347" x2="562" y2="372" stroke="black"/>
<line x1="787" y1="347" x2="787" y2="372" stroke="black"/>
<path d="M 336 364 A112,6 0 0,1 337,353" stroke="black" fill="none"/><polygon fill="black" points="337,365 327,371 327,359"/>
<text x="338" y="357" textLength="71" font-family="Helvetica" font-size="12" fill="black">
Write to short
</text>
<line x1="112" y1="372" x2="112" y2="397" stroke="black"/>
<line x1="337" y1="372" x2="337" y2="397" stroke="black"/>
<line x1="562" y1="372" x2="562" y2="397" stroke="black"/>
<line x1="787" y1="372" x2="787" y2="397" stroke="black"/>
<line x1="337" y1="384" x2="112" y2="384" stroke="black"/>
<line x1="112" y1="384" x2="122" y2="390" stroke="black"/>
<text x="168" y="382" textLength="112" font-family="Helvetica" font-size="12" fill="black">
{ok, SeqNum, Offset}
</text>
<line x1="112" y1="397" x2="112" y2="422" stroke="black"/>
<line x1="337" y1="397" x2="337" y2="422" stroke="black"/>
<line x1="562" y1="397" x2="562" y2="422" stroke="black"/>
<line x1="787" y1="397" x2="787" y2="422" stroke="black"/>
<line x1="112" y1="409" x2="562" y2="409" stroke="black"/>
<line x1="562" y1="409" x2="552" y2="415" stroke="black"/>
<text x="287" y="407" textLength="99" font-family="Helvetica" font-size="12" fill="black">
{sync_msg, Serial}
</text>
<line x1="112" y1="422" x2="112" y2="447" stroke="black"/>
<line x1="337" y1="422" x2="337" y2="447" stroke="black"/>
<line x1="562" y1="422" x2="562" y2="447" stroke="black"/>
<line x1="787" y1="422" x2="787" y2="447" stroke="black"/>
<path d="M 111 439 A112,6 0 0,1 112,428" stroke="black" fill="none"/><polygon fill="black" points="112,440 102,446 102,434"/>
<text x="113" y="432" textLength="216" font-family="Helvetica" font-size="12" fill="black">
Add Serial+Mods to #state.logging_op_q
</text>
<line x1="112" y1="447" x2="112" y2="472" stroke="black"/>
<line x1="337" y1="447" x2="337" y2="472" stroke="black"/>
<line x1="562" y1="447" x2="562" y2="472" stroke="black"/>
<line x1="787" y1="447" x2="787" y2="472" stroke="black"/>
<path d="M 562 453 A112,6 0 0,1 561,464" stroke="black" fill="none"/><polygon fill="black" points="562,465 572,471 572,459"/>
<text x="383" y="457" textLength="176" font-family="Helvetica" font-size="12" fill="black">
Collect more {sync_msg,Serial}...
</text>
<line x1="112" y1="472" x2="112" y2="497" stroke="black"/>
<line x1="337" y1="472" x2="337" y2="497" stroke="black"/>
<line x1="562" y1="472" x2="562" y2="497" stroke="black"/>
<line x1="787" y1="472" x2="787" y2="497" stroke="black"/>
<path d="M 111 489 A112,6 0 0,1 112,478" stroke="black" fill="none"/><polygon fill="black" points="112,490 102,496 102,484"/>
<text x="113" y="482" textLength="333" font-family="Helvetica" font-size="12" fill="black">
Maybe process more Mods requests...goto 'Incr. chain serial...'
</text>
<line x1="112" y1="497" x2="112" y2="522" stroke="black"/>
<line x1="337" y1="497" x2="337" y2="522" stroke="black"/>
<line x1="562" y1="497" x2="562" y2="522" stroke="black"/>
<line x1="787" y1="497" x2="787" y2="522" stroke="black"/>
<line x1="562" y1="509" x2="787" y2="509" stroke="black"/>
<line x1="787" y1="509" x2="777" y2="515" stroke="black"/>
<text x="651" y="507" textLength="46" font-family="Helvetica" font-size="12" fill="black">
Spawn...
</text>
<line x1="112" y1="522" x2="112" y2="547" stroke="black"/>
<line x1="337" y1="522" x2="337" y2="547" stroke="black"/>
<line x1="562" y1="522" x2="562" y2="547" stroke="black"/>
<line x1="787" y1="522" x2="787" y2="547" stroke="black"/>
<path d="M 787 528 A112,6 0 0,1 786,539" stroke="black" fill="none"/><polygon fill="black" points="787,540 797,546 797,534"/>
<text x="682" y="532" textLength="102" font-family="Helvetica" font-size="12" fill="black">
Open shortterm file
</text>
<line x1="112" y1="547" x2="112" y2="572" stroke="black"/>
<line x1="337" y1="547" x2="337" y2="572" stroke="black"/>
<line x1="562" y1="547" x2="562" y2="572" stroke="black"/>
<line x1="787" y1="547" x2="787" y2="572" stroke="black"/>
<path d="M 787 553 A112,6 0 0,1 786,564" stroke="black" fill="none"/><polygon fill="black" points="787,565 797,571 797,559"/>
<text x="733" y="557" textLength="51" font-family="Helvetica" font-size="12" fill="black">
file:sync()
</text>
<line x1="112" y1="572" x2="112" y2="597" stroke="black"/>
<line x1="337" y1="572" x2="337" y2="597" stroke="black"/>
<line x1="562" y1="572" x2="562" y2="597" stroke="black"/>
<line x1="787" y1="572" x2="787" y2="597" stroke="black"/>
<line x1="787" y1="584" x2="112" y2="584" stroke="black"/>
<line x1="112" y1="584" x2="122" y2="590" stroke="black"/>
<text x="373" y="582" textLength="152" font-family="Helvetica" font-size="12" fill="black">
{sync_done,self(),LastSerial}
</text>
<line x1="112" y1="597" x2="112" y2="622" stroke="black"/>
<line x1="337" y1="597" x2="337" y2="622" stroke="black"/>
<line x1="562" y1="597" x2="562" y2="622" stroke="black"/>
<line x1="787" y1="597" x2="787" y2="622" stroke="black"/>
<path d="M 787 603 A112,6 0 0,1 786,614" stroke="black" fill="none"/><polygon fill="black" points="787,615 797,621 797,609"/>
<text x="758" y="607" textLength="26" font-family="Helvetica" font-size="12" fill="black">
exit()
</text>
<line x1="112" y1="622" x2="112" y2="647" stroke="black"/>
<line x1="337" y1="622" x2="337" y2="647" stroke="black"/>
<line x1="562" y1="622" x2="562" y2="647" stroke="black"/>
<line x1="787" y1="622" x2="787" y2="647" stroke="black"/>
<path d="M 111 639 A112,6 0 0,1 112,628" stroke="black" fill="none"/><polygon fill="black" points="112,640 102,646 102,634"/>
<text x="113" y="632" textLength="130" font-family="Helvetica" font-size="12" fill="black">
Find Mods =&lt; LastSerial
</text>
<line x1="112" y1="647" x2="112" y2="672" stroke="black"/>
<line x1="337" y1="647" x2="337" y2="672" stroke="black"/>
<line x1="562" y1="647" x2="562" y2="672" stroke="black"/>
<line x1="787" y1="647" x2="787" y2="672" stroke="black"/>
<path d="M 111 664 A112,6 0 0,1 112,653" stroke="black" fill="none"/><polygon fill="black" points="112,665 102,671 102,659"/>
<text x="113" y="657" textLength="162" font-family="Helvetica" font-size="12" fill="black">
Send Mods downstream, etc...
</text>
<line x1="112" y1="672" x2="112" y2="697" stroke="black"/>
<line x1="337" y1="672" x2="337" y2="697" stroke="black"/>
<line x1="562" y1="672" x2="562" y2="697" stroke="black"/>
<line x1="787" y1="672" x2="787" y2="697" stroke="black"/>
<text x="449" y="687" textLength="0" font-family="Helvetica" font-size="12" fill="black">

</text>
<line x1="56" y1="684" x2="448" y2="684" stroke="black" stroke-dasharray="2,2"/>
<line x1="452" y1="684" x2="844" y2="684" stroke="black" stroke-dasharray="2,2"/>
<line x1="112" y1="697" x2="112" y2="722" stroke="black"/>
<line x1="337" y1="697" x2="337" y2="722" stroke="black"/>
<line x1="562" y1="697" x2="562" y2="722" stroke="black"/>
<line x1="787" y1="697" x2="787" y2="722" stroke="black"/>
<text x="449" y="712" textLength="0" font-family="Helvetica" font-size="12" fill="black">

</text>
<line x1="56" y1="709" x2="448" y2="709" stroke="black" stroke-dasharray="2,2"/>
<line x1="452" y1="709" x2="844" y2="709" stroke="black" stroke-dasharray="2,2"/>
<line x1="112" y1="722" x2="112" y2="747" stroke="black"/>
<line x1="337" y1="722" x2="337" y2="747" stroke="black"/>
<line x1="562" y1="722" x2="562" y2="747" stroke="black"/>
<line x1="787" y1="722" x2="787" y2="747" stroke="black"/>
<text x="449" y="737" textLength="0" font-family="Helvetica" font-size="12" fill="black">

</text>
<line x1="56" y1="734" x2="448" y2="734" stroke="black" stroke-dasharray="2,2"/>
<line x1="452" y1="734" x2="844" y2="734" stroke="black" stroke-dasharray="2,2"/>
</svg>
